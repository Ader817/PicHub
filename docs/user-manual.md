# PicHub - 使用手册

## 启动与访问

### Docker（推荐）
1. 复制环境变量模板：`cp .env.example .env`
2. 填写必要配置（至少 `JWT_SECRET`；如需 AI/地理能力再填 `GEMINI_API_KEY`/`AMAP_API_KEY`）
3. 启动生产模式：`docker compose --profile prod up -d --build`
4. 访问：
   - 前端：`http://localhost`
   - 后端：`http://localhost:8080`
   - API 文档（Swagger UI）：`http://localhost:8080/api-docs`

### Docker 开发模式（代码挂载）
- 启动：`docker compose --profile dev up -d --build`
- 前端（Vite）：`http://localhost:5173`

## 核心功能使用说明

### 注册与登录
![](./images/image.png)

1. 打开网站首页，进入注册页
2. 输入用户名/邮箱/密码完成注册（用户名、密码至少 6 位；用户名/邮箱不可重复）
3. 登录后进入图库页

### 上传图片
![](./images/image-1.png)

1. 在图库页点击上传，选择多张图片上传
2. 上传完成后自动生成缩略图，并尝试提取 EXIF
3. 系统会自动生成 `时间/{年}` 标签；如配置 AMap 且识别到省/市，会生成 `地点/{省}`、`地点/{省}/{市}` 标签

### 查看图片详情与元信息
![](./images/image-2.png)
1. 点击缩略图进入详情页
2. 侧边栏会显示：尺寸、上传时间、拍摄时间、拍摄设备等（仅在信息非空时显示）

### 标签管理
![](./images/image-3.png)

1. 在详情页的标签区域输入标签并添加（支持路径式，如 `人物/同学`）
2. 点击标签可删除（按 UI 提示操作）
3. 点击“生成 AI 标签”可自动生成 `ai` 类型标签（需要配置 `GEMINI_API_KEY`）

### 条件搜索与自然语言搜索
![](./images/image-4.png)

- 条件搜索：在图库页设置筛选条件（标签/关键词等），实时刷新结果
- 自然语言搜索：输入自然语言（如“找 2026 年的照片”），系统会解析并返回结果
  - 若解析失败，页面顶部会显示失败原因，并提示改用条件搜索
  - 若返回 0 条，会显示空态并列出当前生效筛选条件

### 轮播展示
![](./images/image-5.png)

1. 在图库中点击缩略图卡片上的 “★” 将图片加入轮播列表（最多 20 张）
2. 进入轮播页面进行播放

### 图片编辑（裁剪/旋转/调色）
![](./images/image-6.png)

1. 在详情页进入编辑页面
2. 通过裁剪框裁剪；可旋转 90°；可调节亮度/对比度/饱和度/色相
3. 点击“保存副本”：
   - 系统会生成新图片（不覆盖原图）
   - 新副本会继承原图标签
   - 文件名采用 `原名(1).ext`、`原名(2).ext` 的序号策略

### 删除
![](./images/image-7.png)

1. 在详情页点击删除
2. 删除后会移除数据库记录与对应文件（原图/缩略图）

## 常见问题（FAQ）

### “AI 标签/NL 搜索不可用”或报网络/TLS 错误
- Gemini 依赖外部网络与 API Key：请检查 `.env` 的 `GEMINI_API_KEY` 与网络连通性
- 如网络环境对 Google API 不稳定，建议在可用网络下录制演示视频

### “重启容器后图片仍然存在”
- Docker Compose 默认使用 volume（例如 `upload-data`、`mysql-data`）持久化数据
- 这意味着 `docker compose restart` 或 `up -d` 不会丢数据

### “中文文件名显示乱码”
- 项目已对 multipart 文件名的历史编码问题做了兼容处理；如仍出现异常，请确认上传端/浏览器未做特殊转码。
