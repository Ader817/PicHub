openapi: 3.0.3
info:
  title: PicHub API
  version: 1.0.0
servers:
  - url: /api
paths:
  /health:
    get:
      summary: Health check
      responses:
        "200":
          description: OK
  /auth/register:
    post:
      summary: Register
      responses:
        "200":
          description: OK
  /auth/login:
    post:
      summary: Login
      responses:
        "200":
          description: OK
  /auth/me:
    get:
      summary: Get current user
      responses:
        "200":
          description: OK
  /images:
    get:
      summary: List images
      responses:
        "200":
          description: OK
  /images/upload:
    post:
      summary: Upload images
      responses:
        "200":
          description: OK
  /images/{id}:
    get:
      summary: Get image detail
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: OK
        "404":
          description: Not found
    delete:
      summary: Delete image
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: OK
        "404":
          description: Not found
  /images/{id}/filename:
    patch:
      summary: Rename image (update display filename)
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                filename:
                  type: string
              required: [filename]
      responses:
        "200":
          description: OK
        "400":
          description: Validation failed
        "404":
          description: Not found
  /images/{id}/edit:
    post:
      summary: Save edited copy (upload new file)
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: OK
        "400":
          description: Validation failed
        "404":
          description: Not found
  /images/{id}/ai-tags:
    post:
      summary: Generate AI tags for image
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: OK
        "501":
          description: GEMINI_API_KEY not configured
  /images/{id}/tags:
    post:
      summary: Add tag to image
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: OK
        "400":
          description: Validation failed
  /images/{id}/tags/{tagId}:
    delete:
      summary: Remove tag from image
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
        - name: tagId
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: OK
  /images/search:
    post:
      summary: Condition search images
      responses:
        "200":
          description: OK
  /images/nl-search:
    post:
      summary: Natural language search (Gemini parses to criteria)
      responses:
        "200":
          description: OK
        "501":
          description: GEMINI_API_KEY not configured
  /tags:
    get:
      summary: List tags (current user)
      responses:
        "200":
          description: OK
  /carousel:
    get:
      summary: List carousel images (current user)
      responses:
        "200":
          description: OK
    post:
      summary: Add image to carousel
      responses:
        "200":
          description: OK
        "400":
          description: Limit reached
  /carousel/{imageId}:
    delete:
      summary: Remove image from carousel
      parameters:
        - name: imageId
          in: path
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: OK
